<!DOCTYPE html>
<!-- saved from url=(0159)https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Face Recognition for the Happy House - v3</title>
    <link rel="shortcut icon" type="image/x-icon" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/static/base/images/favicon.ico?v=97c6417ed01bdc0ae3ef32ae4894fd03">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Face Recognition for the Happy House - v3_files/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./Face Recognition for the Happy House - v3_files/jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Face Recognition for the Happy House - v3_files/MathJax.js.下载" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/user/gepukqzycdbjevzfhqjgdk/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./Face Recognition for the Happy House - v3_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Face Recognition for the Happy House - v3_files/codemirror.css">


    <link rel="stylesheet" href="./Face Recognition for the Happy House - v3_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Face Recognition for the Happy House - v3_files/override.css" type="text/css">
<link rel="stylesheet" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Face Recognition for the Happy House - v3_files/custom.css" type="text/css">
    <script src="./Face Recognition for the Happy House - v3_files/promise.min.js.下载" type="text/javascript" charset="utf-8"></script>
    <script src="./Face Recognition for the Happy House - v3_files/index.js.下载" type="text/javascript"></script>
    <script src="./Face Recognition for the Happy House - v3_files/index.js(1).下载" type="text/javascript"></script>
    <script src="./Face Recognition for the Happy House - v3_files/index.js(2).下载" type="text/javascript"></script>
    <script src="./Face Recognition for the Happy House - v3_files/require.js.下载" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20180516085236",
          
          baseUrl: '/user/gepukqzycdbjevzfhqjgdk/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/user/gepukqzycdbjevzfhqjgdk/custom',
            nbextensions : '/user/gepukqzycdbjevzfhqjgdk/nbextensions',
            kernelspecs : '/user/gepukqzycdbjevzfhqjgdk/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Face Recognition for the Happy House - v3_files/contents.js.下载"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Face Recognition for the Happy House - v3_files/custom.js.下载"></script><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/submit_button/main" src="./Face Recognition for the Happy House - v3_files/main.js.下载"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./Face Recognition for the Happy House - v3_files/extension.js.下载"></script><link id="favicon" type="image/x-icon" rel="shortcut icon" href="https://hub.coursera-notebooks.org/static/base/images/favicon.ico"></head>

<body class="notebook_app command_mode" data-base-url="/user/gepukqzycdbjevzfhqjgdk/" data-ws-url="" data-notebook-name="Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb" data-notebook-path="week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb" dir="ltr" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed.
  </div>
</noscript>

<div id="header" style="background-color: rgb(204, 232, 207); display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/tree" title="dashboard">
<img src="./Face Recognition for the Happy House - v3_files/logo" alt="Jupyter Notebook">
</a></div>

  

  
  

    <span id="login_widget">
      
        <button id="logout" class="btn btn-sm navbar-btn" style="background-color: rgb(204, 232, 207);">Logout</button>
      
    </span>

  

  

<a href="https://hub.coursera-notebooks.org/hub/home" class="btn btn-default btn-sm navbar-btn pull-right" style="margin-right: 4px; margin-left: 2px; background-color: rgb(204, 232, 207);">
Control Panel</a>


  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Face Recognition for the Happy House - v3</span>
    <span class="checkpoint_status" title="Wed, May 16, 2018 5:17 PM">Last Checkpoint: a minute ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="./Face Recognition for the Happy House - v3_files/logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation" style="background-color: rgb(204, 232, 207);">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none; background-color: rgb(204, 232, 207);"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="display: inline-block; background-color: rgb(204, 232, 207);"><span>Not Trusted</span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu" style="background-color: rgb(204, 232, 207);"><li id="new-notebook-submenu-python3"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Python 3</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu" style="background-color: rgb(204, 232, 207);"><li><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Wednesday, May 16, 2018 5:17 PM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Download as</a>
                            <ul id="download_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                                <li id="download_ipynb"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">reST (.rst)</a></li>
                                <li id="download_latex"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">LaTeX (.tex)</a></li>
                                <li id="download_pdf"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);"></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Trust Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                        <li id="cut_cell"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Delete Cells</a></li>
                        <li id="undelete_cell" class="disabled"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#"> Find and Replace </a></li>
                        <li class="divider"></li>
                        <li id="cut_cell_attachments"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Paste Cell Attachments</a></li>
                        <li class="divider"></li>
                        <li id="insert_image" class="disabled"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#"> Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" title="Show/Hide line numbers in cells">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Toggle Line Numbers</a>
                        </li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu" style="background-color: rgb(204, 232, 207);"><li data-name="None"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Slideshow</a></li><li data-name="Attachments"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Attachments</a></li><li data-name="Tags"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Current Outputs</a>
                            <ul class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">All Output</a>
                            <ul class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Shutdown</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu" style="background-color: rgb(204, 232, 207);"><li id="kernel-submenu-python3"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu" style="background-color: rgb(204, 232, 207);">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a dialog which shows all keyboard shortcuts"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Keyboard Shortcuts</a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/3.6?v=20180516085236"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html?v=20180516085236"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/?v=20180516085236"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/?v=20180516085236"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html?v=20180516085236"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20180516085236"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/?v=20180516085236"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook" style="background-color: rgb(204, 232, 207);"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below" style="background-color: rgb(204, 232, 207);"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell" style="background-color: rgb(204, 232, 207);"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell" style="background-color: rgb(204, 232, 207);"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below" style="background-color: rgb(204, 232, 207);"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up" style="background-color: rgb(204, 232, 207);"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down" style="background-color: rgb(204, 232, 207);"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next" style="background-color: rgb(204, 232, 207);"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel" style="background-color: rgb(204, 232, 207);"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel" style="background-color: rgb(204, 232, 207);"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs" style="background-color: rgb(204, 232, 207);"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette" style="background-color: rgb(204, 232, 207);"><i class="fa-keyboard-o fa"></i></button></div><div class="btn-group" id="submit-notebook-button-group" style="float:right"><button class="btn btn-default" title="Submit this notebook for grading." id="submit-notebook-button" style="background-color:rgb(42, 115, 204); color:white; padding:4px 8px">Submit Assignment</button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 490px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container" style="background-color: rgb(204, 232, 207);"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 515px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Face Recognition for the Happy House</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Welcome to the first assignment of week 4! Here you will build a face recognition system. Many of the ideas presented here are from <span class="cm-link">[FaceNet]</span><span class="cm-string cm-url">(https://arxiv.org/pdf/1503.03832.pdf)</span>. In lecture, we also talked about <span class="cm-link">[DeepFace]</span><span class="cm-string cm-url">(https://research.fb.com/wp-content/uploads/2016/11/deepface-closing-the-gap-to-human-level-performance-in-face-verification.pdf)</span>. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Face recognition problems commonly fall into two categories: </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Face Verification**</span><span class="cm-variable-2"> - "is this the claimed person?". For example, at some airports, you can pass through customs by letting a system scan your passport and then verifying that you (the person carrying the passport) are the correct person. A mobile phone that unlocks using your face is also using face verification. This is a 1:1 matching problem. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Face Recognition**</span><span class="cm-variable-2"> - "who is this person?". For example, the video lecture showed a face recognition video (</span><span class="cm-variable-2 cm-link">https://www.youtube.com/watch?v=wr4rx0Spihs</span><span class="cm-variable-2">) of Baidu employees entering the office without needing to otherwise identify themselves. This is a 1:K matching problem. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">FaceNet learns a neural network that encodes a face image into a vector of 128 numbers. By comparing two such vectors, you can then determine if two pictures are of the same person.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**In this assignment, you will:**</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Implement the triplet loss function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Use a pretrained model to map face images into 128-dimensional encodings</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Use these encodings to perform face verification and face recognition</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In this exercise, we will be using a pre-trained model which represents ConvNet activations using a "channels first" convention, as opposed to the "channels last" convention used in lecture and previous programming assignments. In other words, a batch of images will be of shape <span class="cm-delimit cm-delimit-open">$</span>(m, n_C, n_H, n_W)<span class="cm-delimit cm-delimit-close">$</span> instead of <span class="cm-delimit cm-delimit-open">$</span>(m, n_H, n_W, n_C)<span class="cm-delimit cm-delimit-close">$</span>. Both of these conventions have a reasonable amount of traction among open-source implementations; there isn't a uniform standard yet within the deep learning community. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's load the required packages. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 515px;"></div><div class="CodeMirror-gutters" style="display: none; height: 534px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Face-Recognition-for-the-Happy-House">Face Recognition for the Happy House<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#Face-Recognition-for-the-Happy-House">¶</a></h1>
<p>Welcome to the first assignment of week 4! Here you will build a face recognition system. Many of the ideas presented here are from <a href="https://arxiv.org/pdf/1503.03832.pdf" target="_blank">FaceNet</a>. In lecture, we also talked about <a href="https://research.fb.com/wp-content/uploads/2016/11/deepface-closing-the-gap-to-human-level-performance-in-face-verification.pdf" target="_blank">DeepFace</a>. </p>
<p>Face recognition problems commonly fall into two categories: </p>
<ul>
<li><strong>Face Verification</strong> - "is this the claimed person?". For example, at some airports, you can pass through customs by letting a system scan your passport and then verifying that you (the person carrying the passport) are the correct person. A mobile phone that unlocks using your face is also using face verification. This is a 1:1 matching problem. </li>
<li><strong>Face Recognition</strong> - "who is this person?". For example, the video lecture showed a face recognition video (<a href="https://www.youtube.com/watch?v=wr4rx0Spihs" target="_blank">https://www.youtube.com/watch?v=wr4rx0Spihs</a>) of Baidu employees entering the office without needing to otherwise identify themselves. This is a 1:K matching problem. </li>
</ul>
<p>FaceNet learns a neural network that encodes a face image into a vector of 128 numbers. By comparing two such vectors, you can then determine if two pictures are of the same person.</p>
<p><strong>In this assignment, you will:</strong></p>
<ul>
<li>Implement the triplet loss function</li>
<li>Use a pretrained model to map face images into 128-dimensional encodings</li>
<li>Use these encodings to perform face verification and face recognition</li>
</ul>
<p>In this exercise, we will be using a pre-trained model which represents ConvNet activations using a "channels first" convention, as opposed to the "channels last" convention used in lecture and previous programming assignments. In other words, a batch of images will be of shape <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mo" id="MJXp-Span-2" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">m</span><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-7" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-11" style="vertical-align: -0.4em;">H</span></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-15" style="vertical-align: -0.4em;">W</span></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-1-Frame" tabindex="0" style=""></span><script type="math/tex" id="MathJax-Element-1">(m, n_C, n_H, n_W)</script> instead of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">m</span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-23" style="vertical-align: -0.4em;">H</span></span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-27" style="vertical-align: -0.4em;">W</span></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-31" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-2-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-2">(m, n_H, n_W, n_C)</script>. Both of these conventions have a reasonable amount of traction among open-source implementations; there isn't a uniform standard yet within the deep learning community. </p>
<p>Let's load the required packages. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[1]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 88.9271px; left: 153.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 551.667px; margin-bottom: -11px; border-right-width: 19px; min-height: 428px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 148px; top: 83.3333px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">models</span> <span class="cm-keyword">import</span> <span class="cm-variable">Sequential</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span> <span class="cm-keyword">import</span> <span class="cm-variable">Conv2D</span>, <span class="cm-variable">ZeroPadding2D</span>, <span class="cm-variable">Activation</span>, <span class="cm-variable">Input</span>, <span class="cm-variable">concatenate</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">models</span> <span class="cm-keyword">import</span> <span class="cm-variable">Model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">normalization</span> <span class="cm-keyword">import</span> <span class="cm-variable">BatchNormalization</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">pooling</span> <span class="cm-keyword">import</span> <span class="cm-variable">MaxPooling2D</span>, <span class="cm-variable">AveragePooling2D</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">merge</span> <span class="cm-keyword">import</span> <span class="cm-variable">Concatenate</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">core</span> <span class="cm-keyword">import</span> <span class="cm-variable">Lambda</span>, <span class="cm-variable">Flatten</span>, <span class="cm-variable">Dense</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">initializers</span> <span class="cm-keyword">import</span> <span class="cm-variable">glorot_uniform</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-property">engine</span>.<span class="cm-property">topology</span> <span class="cm-keyword">import</span> <span class="cm-variable">Layer</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span> <span class="cm-keyword">import</span> <span class="cm-variable">backend</span> <span class="cm-keyword">as</span> <span class="cm-variable">K</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">K</span>.<span class="cm-property">set_image_data_format</span>(<span class="cm-string">'channels_first'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">cv2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">os</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">import</span> <span class="cm-variable">genfromtxt</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">tensorflow</span> <span class="cm-keyword">as</span> <span class="cm-variable">tf</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">fr_utils</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">inception_blocks_v2</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">matplotlib</span> <span class="cm-variable">inline</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">load_ext</span> <span class="cm-variable">autoreload</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">autoreload</span> <span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">set_printoptions</span>(<span class="cm-variable">threshold</span>=<span class="cm-variable">np</span>.<span class="cm-property">nan</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 428px;"></div><div class="CodeMirror-gutters" style="display: none; height: 447px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stderr"><pre>Using TensorFlow backend.
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 131px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 0 - Naive Face Verification</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In Face Verification, you're given two images and you have to tell if they are of the same person. The simplest way to do this is to compare the two images pixel-by-pixel. If the distance between the raw images are less than a chosen threshold, it may be the same person! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/pixel_comparison.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:380px;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 1** <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 131px;"></div><div class="CodeMirror-gutters" style="display: none; height: 150px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="0---Naive-Face-Verification">0 - Naive Face Verification<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#0---Naive-Face-Verification">¶</a></h2>
<p>In Face Verification, you're given two images and you have to tell if they are of the same person. The simplest way to do this is to compare the two images pixel-by-pixel. If the distance between the raw images are less than a chosen threshold, it may be the same person! </p>
<p><img src="./Face Recognition for the Happy House - v3_files/pixel_comparison.png" style="width: 380px ; height: 150px"></p>
<center> <u> <font color="purple"> <strong>Figure 1</strong> </font></u></center></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 95px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Of course, this algorithm performs really poorly, since the pixel values change dramatically due to variations in lighting, orientation of the person's face, even minor changes in head position, and so on. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You'll see that rather than using the raw image, you can learn an encoding <span class="cm-delimit cm-delimit-open">$</span>f(img)<span class="cm-delimit cm-delimit-close">$</span> so that element-wise comparisons of this encoding gives more accurate judgements as to whether two pictures are of the same person.</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 95px;"></div><div class="CodeMirror-gutters" style="display: none; height: 114px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Of course, this algorithm performs really poorly, since the pixel values change dramatically due to variations in lighting, orientation of the person's face, even minor changes in head position, and so on. </p>
<p>You'll see that rather than using the raw image, you can learn an encoding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">f</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">g</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-3-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-3">f(img)</script> so that element-wise comparisons of this encoding gives more accurate judgements as to whether two pictures are of the same person.</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 165px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1 - Encoding face images into a 128-dimensional vector </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 1.1 - Using an ConvNet  to compute encodings</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The FaceNet model takes a lot of data and a long time to train. So following common practice in applied deep learning settings, let's just load weights that someone else has already trained. The network architecture follows the Inception model from <span class="cm-link">[Szegedy </span><span class="cm-em cm-link">*et al.*</span><span class="cm-link">]</span><span class="cm-string cm-url">(https://arxiv.org/abs/1409.4842)</span>. We have provided an inception network implementation. You can look in the file <span class="cm-comment">`inception_blocks.py`</span> to see how it is implemented (do so by going to "File-&gt;Open..." at the top of the Jupyter notebook).<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 165px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1---Encoding-face-images-into-a-128-dimensional-vector">1 - Encoding face images into a 128-dimensional vector<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#1---Encoding-face-images-into-a-128-dimensional-vector">¶</a></h2>
<h3 id="1.1---Using-an-ConvNet--to-compute-encodings">1.1 - Using an ConvNet  to compute encodings<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#1.1---Using-an-ConvNet--to-compute-encodings">¶</a></h3>
<p>The FaceNet model takes a lot of data and a long time to train. So following common practice in applied deep learning settings, let's just load weights that someone else has already trained. The network architecture follows the Inception model from <a href="https://arxiv.org/abs/1409.4842" target="_blank">Szegedy <em>et al.</em></a>. We have provided an inception network implementation. You can look in the file <code style="background-color: rgb(204, 232, 207);">inception_blocks.py</code> to see how it is implemented (do so by going to "File-&gt;Open..." at the top of the Jupyter notebook).  </p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 128px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The key things you need to know are:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- This network uses 96x96 dimensional RGB images as its input. Specifically, inputs a face image (or batch of </span><span class="cm-delimit cm-delimit-open">$</span>m<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> face images) as a tensor of shape </span><span class="cm-delimit cm-delimit-open">$</span>(m, n_C, n_H, n_W) = (m, 3, 96, 96)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- It outputs a matrix of shape </span><span class="cm-delimit cm-delimit-open">$</span>(m, 128)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> that encodes each input face image into a 128-dimensional vector</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Run the cell below to create the model for face images.</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 128px;"></div><div class="CodeMirror-gutters" style="display: none; height: 147px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The key things you need to know are:</p>
<ul>
<li>This network uses 96x96 dimensional RGB images as its input. Specifically, inputs a face image (or batch of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-4-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-4">m</script> face images) as a tensor of shape <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">m</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-48" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;">H</span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-54"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-56" style="vertical-align: -0.4em;">W</span></span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">m</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-62">3</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-64">96</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-66">96</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-5-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-5">(m, n_C, n_H, n_W) = (m, 3, 96, 96)</script> </li>
<li>It outputs a matrix of shape <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">m</span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-72">128</span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-6-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-6">(m, 128)</script> that encodes each input face image into a 128-dimensional vector</li>
</ul>
<p>Run the cell below to create the model for face images.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[2]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 339px; margin-bottom: -11px; border-right-width: 19px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FRmodel</span> = <span class="cm-variable">faceRecoModel</span>(<span class="cm-variable">input_shape</span>=(<span class="cm-number">3</span>, <span class="cm-number">96</span>, <span class="cm-number">96</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 47px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 325px; margin-bottom: -11px; border-right-width: 19px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Total Params:"</span>, <span class="cm-variable">FRmodel</span>.<span class="cm-property">count_params</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 47px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Total Params: 3743280
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 128px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">** Expected Output **</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Total Params: <span class="cm-link">3743280</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 128px;"></div><div class="CodeMirror-gutters" style="display: none; height: 147px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong> Expected Output </strong></p>
<center>
Total Params: 3743280
</center><table>

</table>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 311px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6666px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">By using a 128-neuron fully connected layer as its last layer, the model ensures that the output is an encoding vector of size 128. You then use the encodings the compare two face images as follows:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/distance_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:680px;height:250px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 2**: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> By computing a distance between two encodings and thresholding, you can determine if the two pictures represent the same person<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">So, an encoding is a good one if: </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- The encodings of two images of the same person are quite similar to each other </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- The encodings of two images of different persons are very different</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The triplet loss function formalizes this, and tries to "push" the encodings of two images of the same person (Anchor and Positive) closer together, while "pulling" the encodings of two images of different persons (Anchor, Negative) further apart. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/triplet_comparison.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:280px;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 3**: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> In the next part, we will call the pictures from left to right: Anchor (A), Positive (P), Negative (N) &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 311px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>By using a 128-neuron fully connected layer as its last layer, the model ensures that the output is an encoding vector of size 128. You then use the encodings the compare two face images as follows:</p>
<p><img src="./Face Recognition for the Happy House - v3_files/distance_kiank.png" style="width: 680px ; height: 250px"></p>
<center> <u> <font color="purple"> <strong>Figure 2</strong>: <br> </font></u> <font color="purple"> By computing a distance between two encodings and thresholding, you can determine if the two pictures represent the same person</font></center>

<p>So, an encoding is a good one if: </p>
<ul>
<li>The encodings of two images of the same person are quite similar to each other </li>
<li>The encodings of two images of different persons are very different</li>
</ul>
<p>The triplet loss function formalizes this, and tries to "push" the encodings of two images of the same person (Anchor and Positive) closer together, while "pulling" the encodings of two images of different persons (Anchor, Negative) further apart. </p>
<p><img src="./Face Recognition for the Happy House - v3_files/triplet_comparison.png" style="width: 280px ; height: 150px">
<br></p>
<center> <u> <font color="purple"> <strong>Figure 3</strong>: <br> </font></u> <font color="purple"> In the next part, we will call the pictures from left to right: Anchor (A), Positive (P), Negative (N)  </font></center></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 912px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 1.2 - The Triplet Loss</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">For an image <span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span>, we denote its encoding <span class="cm-delimit cm-delimit-open">$</span>f(x)<span class="cm-delimit cm-delimit-close">$</span>, where <span class="cm-delimit cm-delimit-open">$</span>f<span class="cm-delimit cm-delimit-close">$</span> is the function computed by the neural network.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/f_x.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:380px;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">We will also add a normalization step at the end of our model so that </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(x) <span class="cm-tag">\mid</span>&nbsp;<span class="cm-tag">\mid</span>_2 = 1<span class="cm-delimit cm-delimit-close">$</span> <span class="cm-comment">(means the vector of encoding should be of norm 1).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">!--&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Training will use triplets of images <span class="cm-delimit cm-delimit-open">$</span>(A, P, N)<span class="cm-delimit cm-delimit-close">$</span>:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- A is an "Anchor" image--a picture of a person. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- P is a "Positive" image--a picture of the same person as the Anchor image.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- N is a "Negative" image--a picture of a different person than the Anchor image.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">These triplets are picked from our training dataset. We will write <span class="cm-delimit cm-delimit-open">$</span>(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>, P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>, N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span> to denote the <span class="cm-delimit cm-delimit-open">$</span>i<span class="cm-delimit cm-delimit-close">$</span>-th training example. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You'd like to make sure that an image <span class="cm-delimit cm-delimit-open">$</span>A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> of an individual is closer to the Positive <span class="cm-delimit cm-delimit-open">$</span>P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> than to the Negative image <span class="cm-delimit cm-delimit-open">$</span>N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>) by at least a margin <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\alpha</span><span class="cm-delimit cm-delimit-close">$</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2 + <span class="cm-tag">\alpha</span> &lt; <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2<span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You would thus like to minimize the following "triplet cost":</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span><span class="cm-tag">\mathcal</span><span class="cm-bracket">{</span>J<span class="cm-bracket">}</span> = <span class="cm-tag">\sum</span>^<span class="cm-bracket">{</span>m<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>i=1<span class="cm-bracket">}</span> <span class="cm-tag">\large</span><span class="cm-bracket">[</span> <span class="cm-tag">\small</span> <span class="cm-tag">\underbrace</span><span class="cm-bracket">{</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2<span class="cm-bracket">}</span>_<span class="cm-tag">\text</span><span class="cm-bracket">{</span>(1)<span class="cm-bracket">}</span> - <span class="cm-tag">\underbrace</span><span class="cm-bracket">{</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2<span class="cm-bracket">}</span>_<span class="cm-tag">\text</span><span class="cm-bracket">{</span>(2)<span class="cm-bracket">}</span> + <span class="cm-tag">\alpha</span> <span class="cm-tag">\large</span> <span class="cm-bracket">]</span> <span class="cm-tag">\small</span>_+&nbsp;<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">3</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Here, we are using the notation "<span class="cm-delimit cm-delimit-open">$</span><span class="cm-bracket">[</span>z<span class="cm-bracket">]</span>_+<span class="cm-delimit cm-delimit-close">$</span>" to denote <span class="cm-delimit cm-delimit-open">$</span>max(z,0)<span class="cm-delimit cm-delimit-close">$</span>.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Notes:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- The term (1) is the squared distance between the anchor "A" and the positive "P" for a given triplet; you want this to be small. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- The term (2) is the squared distance between the anchor "A" and the negative "N" for a given triplet, you want this to be relatively large, so it thus makes sense to have a minus sign preceding it. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\alpha</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is called the margin. It is a hyperparameter that you should pick manually. We will use </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\alpha</span> = 0.2<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Most implementations also normalize the encoding vectors  to have norm equal one (i.e., <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(img)<span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2<span class="cm-delimit cm-delimit-close">$</span>=1); you won't have to worry about that here.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement the triplet loss as defined by formula (3). Here are the 4 steps:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Compute the distance between the encodings of "anchor" and "positive": </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Compute the distance between the encodings of "anchor" and "negative": </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Compute the formula per training example: </span><span class="cm-delimit cm-delimit-open">$</span> <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> - <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2 + <span class="cm-tag">\alpha</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Compute the full formula by taking the max with zero and summing over the training examples:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span><span class="cm-tag">\mathcal</span><span class="cm-bracket">{</span>J<span class="cm-bracket">}</span> = <span class="cm-tag">\sum</span>^<span class="cm-bracket">{</span>m<span class="cm-bracket">}</span>_<span class="cm-bracket">{</span>i=1<span class="cm-bracket">}</span> <span class="cm-tag">\large</span><span class="cm-bracket">[</span> <span class="cm-tag">\small</span> <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2 - <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2+ <span class="cm-tag">\alpha</span> <span class="cm-tag">\large</span> <span class="cm-bracket">]</span> <span class="cm-tag">\small</span>_+&nbsp;<span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">3</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Useful functions: <span class="cm-comment">`tf.reduce_sum()`</span>, <span class="cm-comment">`tf.square()`</span>, <span class="cm-comment">`tf.subtract()`</span>, <span class="cm-comment">`tf.add()`</span>, <span class="cm-comment">`tf.maximum()`</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">For steps 1 and 2, you will need to sum over the entries of <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(P^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2<span class="cm-delimit cm-delimit-close">$</span> and <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span> f(A^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) - f(N^<span class="cm-bracket">{</span>(i)<span class="cm-bracket">}</span>) <span class="cm-tag">\mid</span> <span class="cm-tag">\mid</span>_2^2<span class="cm-delimit cm-delimit-close">$</span> while for step 4 you will need to sum over the training examples.</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 912px;"></div><div class="CodeMirror-gutters" style="display: none; height: 931px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="1.2---The-Triplet-Loss">1.2 - The Triplet Loss<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#1.2---The-Triplet-Loss">¶</a></h3>
<p>For an image <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-7-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-7">x</script>, we denote its encoding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">f</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">x</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-8-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-8">f(x)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-9-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-9">f</script> is the function computed by the neural network.</p>
<p><img src="./Face Recognition for the Happy House - v3_files/f_x.png" style="width: 380px ; height: 150px"></p>

<p>Training will use triplets of images <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">A</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">P</span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">N</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-10-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-10">(A, P, N)</script>:  </p>
<ul>
<li>A is an "Anchor" image--a picture of a person. </li>
<li>P is a "Positive" image--a picture of the same person as the Anchor image.</li>
<li>N is a "Negative" image--a picture of a different person than the Anchor image.</li>
</ul>
<p>These triplets are picked from our training dataset. We will write <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-95" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-96">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">i</span><span class="MJXp-mo" id="MJXp-Span-98">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-102" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-103">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">i</span><span class="MJXp-mo" id="MJXp-Span-105">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-109" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-110">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">i</span><span class="MJXp-mo" id="MJXp-Span-112">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-11-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-11">(A^{(i)}, P^{(i)}, N^{(i)})</script> to denote the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-12-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-12">i</script>-th training example. </p>
<p>You'd like to make sure that an image <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-116"><span class="MJXp-msubsup" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-119" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-120">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">i</span><span class="MJXp-mo" id="MJXp-Span-122">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-13-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-13">A^{(i)}</script> of an individual is closer to the Positive <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-123"><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-126" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-127">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">i</span><span class="MJXp-mo" id="MJXp-Span-129">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-14-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-14">P^{(i)}</script> than to the Negative image <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-msubsup" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-133" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-134">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">i</span><span class="MJXp-mo" id="MJXp-Span-136">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-15-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-15">N^{(i)}</script>) by at least a margin <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-16-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-16">\alpha</script>:</p>
<p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-139"><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">f</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-146" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-147">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">i</span><span class="MJXp-mo" id="MJXp-Span-149">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">f</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-156" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-157">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">i</span><span class="MJXp-mo" id="MJXp-Span-159">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-162"><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-165">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-164">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">α</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;∣∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">f</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-173" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-174">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">i</span><span class="MJXp-mo" id="MJXp-Span-176">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">f</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-183" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-184">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">i</span><span class="MJXp-mo" id="MJXp-Span-186">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-192">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-191">2</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">\mid \mid f(A^{(i)}) - f(P^{(i)}) \mid \mid_2^2 + \alpha < \mid \mid f(A^{(i)}) - f(N^{(i)}) \mid \mid_2^2</script></p>
<p>You would thus like to minimize the following "triplet cost":</p>
<p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-193"><span class="MJXp-mtable" id="MJXp-Span-194"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-195" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-196" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-197"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-198">J</span></span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-200"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-206" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-202" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">i</span><span class="MJXp-mo" id="MJXp-Span-204">=</span><span class="MJXp-mn" id="MJXp-Span-205">1</span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-208"><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mstyle" id="MJXp-Span-210"><span class="MJXp-munderover" id="MJXp-Span-211"><span class=""><span class="MJXp-mrow" id="MJXp-Span-212"><span class="MJXp-munderover" id="MJXp-Span-213"><span class=""><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">f</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-220" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-221">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">i</span><span class="MJXp-mo" id="MJXp-Span-223">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">f</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-230" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-231">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">i</span><span class="MJXp-mo" id="MJXp-Span-233">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-236"><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-239">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-238">2</span></span></span></span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-241" style="margin-left: 0px;">(1)</span></span></span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-243"><span class=""><span class="MJXp-mrow" id="MJXp-Span-244"><span class="MJXp-munderover" id="MJXp-Span-245"><span class=""><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">f</span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-252" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-253">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">i</span><span class="MJXp-mo" id="MJXp-Span-255">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">f</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-262" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-263">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">i</span><span class="MJXp-mo" id="MJXp-Span-265">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-268"><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-271">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-270">2</span></span></span></span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mtext" id="MJXp-Span-273" style="margin-left: 0px;">(2)</span></span></span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">α</span><span class="MJXp-mstyle" id="MJXp-Span-276"><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mstyle" id="MJXp-Span-278"><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mi" id="MJXp-Span-280" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-281" style="vertical-align: -0.4em;">+</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">\mathcal{J} = \sum^{m}_{i=1} \large[ \small \underbrace{\mid \mid f(A^{(i)}) - f(P^{(i)}) \mid \mid_2^2}_\text{(1)} - \underbrace{\mid \mid f(A^{(i)}) - f(N^{(i)}) \mid \mid_2^2}_\text{(2)} + \alpha \large ] \small_+ \tag{3}</script></p>
<p>Here, we are using the notation "<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">z</span><span class="MJXp-msubsup" id="MJXp-Span-285"><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-287" style="vertical-align: -0.4em;">+</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-19-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-19">[z]_+</script>" to denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">x</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">z</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-295">0</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-20-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-20">max(z,0)</script>.  </p>
<p>Notes:</p>
<ul>
<li>The term (1) is the squared distance between the anchor "A" and the positive "P" for a given triplet; you want this to be small. </li>
<li>The term (2) is the squared distance between the anchor "A" and the negative "N" for a given triplet, you want this to be relatively large, so it thus makes sense to have a minus sign preceding it. </li>
<li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-21-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-21">\alpha</script> is called the margin. It is a hyperparameter that you should pick manually. We will use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">α</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-302">0.2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-22-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-22">\alpha = 0.2</script>. </li>
</ul>
<p>Most implementations also normalize the encoding vectors  to have norm equal one (i.e., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-303"><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">f</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">g</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-315" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-23">\mid \mid f(img)\mid \mid_2</script>=1); you won't have to worry about that here.</p>
<p><strong>Exercise</strong>: Implement the triplet loss as defined by formula (3). Here are the 4 steps:</p>
<ol>
<li>Compute the distance between the encodings of "anchor" and "positive": <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">f</span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-323" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-324">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">i</span><span class="MJXp-mo" id="MJXp-Span-326">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">f</span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-333" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-334">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">i</span><span class="MJXp-mo" id="MJXp-Span-336">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-342">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-341">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-24">\mid \mid f(A^{(i)}) - f(P^{(i)}) \mid \mid_2^2</script></li>
<li>Compute the distance between the encodings of "anchor" and "negative": <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-343"><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">f</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-350" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-351">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">i</span><span class="MJXp-mo" id="MJXp-Span-353">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">f</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-360" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-361">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">i</span><span class="MJXp-mo" id="MJXp-Span-363">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-369">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-368">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-25-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-25">\mid \mid f(A^{(i)}) - f(N^{(i)}) \mid \mid_2^2</script></li>
<li>Compute the formula per training example: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-370"><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">f</span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-377" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-378">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">i</span><span class="MJXp-mo" id="MJXp-Span-380">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">f</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-387" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-388">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">i</span><span class="MJXp-mo" id="MJXp-Span-390">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0.333em; margin-right: 0.333em;">∣∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">f</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-399" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-400">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">i</span><span class="MJXp-mo" id="MJXp-Span-402">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">f</span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-409" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-410">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">i</span><span class="MJXp-mo" id="MJXp-Span-412">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0.333em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-418">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-417">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-26-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-26"> \mid \mid f(A^{(i)}) - f(P^{(i)}) \mid - \mid \mid f(A^{(i)}) - f(N^{(i)}) \mid \mid_2^2 + \alpha</script></li>
<li>Compute the full formula by taking the max with zero and summing over the training examples:
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-421"><span class="MJXp-mtable" id="MJXp-Span-422"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-423" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-424" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-425"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-426">J</span></span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-428"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-434" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-430" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">i</span><span class="MJXp-mo" id="MJXp-Span-432">=</span><span class="MJXp-mn" id="MJXp-Span-433">1</span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-436"><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mstyle" id="MJXp-Span-438"><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">f</span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-445" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-446">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">i</span><span class="MJXp-mo" id="MJXp-Span-448">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">f</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-455" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-456">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">i</span><span class="MJXp-mo" id="MJXp-Span-458">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-461"><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0.333em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-464">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-463">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.333em; margin-right: 0.333em;">∣∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">f</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-471" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-472">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">i</span><span class="MJXp-mo" id="MJXp-Span-474">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">f</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-481" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-482">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">i</span><span class="MJXp-mo" id="MJXp-Span-484">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-487"><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0.333em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-490">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-489">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">α</span><span class="MJXp-mstyle" id="MJXp-Span-493"><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mstyle" id="MJXp-Span-495"><span class="MJXp-msubsup" id="MJXp-Span-496"><span class="MJXp-mi" id="MJXp-Span-497" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-498" style="vertical-align: -0.4em;">+</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">\mathcal{J} = \sum^{m}_{i=1} \large[ \small \mid \mid f(A^{(i)}) - f(P^{(i)}) \mid \mid_2^2 - \mid \mid f(A^{(i)}) - f(N^{(i)}) \mid \mid_2^2+ \alpha \large ] \small_+ \tag{3}</script></li>
</ol>
<p>Useful functions: <code style="background-color: rgb(204, 232, 207);">tf.reduce_sum()</code>, <code style="background-color: rgb(204, 232, 207);">tf.square()</code>, <code style="background-color: rgb(204, 232, 207);">tf.subtract()</code>, <code style="background-color: rgb(204, 232, 207);">tf.add()</code>, <code style="background-color: rgb(204, 232, 207);">tf.maximum()</code>.
For steps 1 and 2, you will need to sum over the entries of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-499"><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">f</span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-506" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-507">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">i</span><span class="MJXp-mo" id="MJXp-Span-509">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">f</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-516" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-517">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">i</span><span class="MJXp-mo" id="MJXp-Span-519">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-525">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-524">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">\mid \mid f(A^{(i)}) - f(P^{(i)}) \mid \mid_2^2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-526"><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0em; margin-right: 0em;">∣</span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">f</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-533" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-534">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">i</span><span class="MJXp-mo" id="MJXp-Span-536">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">f</span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-543" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-544">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">i</span><span class="MJXp-mo" id="MJXp-Span-546">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-549"><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0em; margin-right: 0.05em;">∣</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-552">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-551">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-29-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-29">\mid \mid f(A^{(i)}) - f(N^{(i)}) \mid \mid_2^2</script> while for step 4 you will need to sum over the training examples.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 405.594px; left: 453.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 815px; margin-bottom: -11px; border-right-width: 19px; min-height: 528px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 448px; top: 400px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: triplet_loss</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">triplet_loss</span>(<span class="cm-variable">y_true</span>, <span class="cm-variable">y_pred</span>, <span class="cm-variable">alpha</span> = <span class="cm-number">0.2</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implementation of the triplet loss as defined by formula (3)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    y_true -- true labels, required when you define a loss in Keras, you don't need it in this function.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    y_pred -- python list containing three objects:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">            anchor -- the encodings for the anchor images, of shape (None, 128)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">            positive -- the encodings for the positive images, of shape (None, 128)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">            negative -- the encodings for the negative images, of shape (None, 128)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    loss -- real number, value of the loss</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">anchor</span>, <span class="cm-variable">positive</span>, <span class="cm-variable">negative</span> = <span class="cm-variable">y_pred</span>[<span class="cm-number">0</span>], <span class="cm-variable">y_pred</span>[<span class="cm-number">1</span>], <span class="cm-variable">y_pred</span>[<span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (≈ 4 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 1: Compute the (encoding) distance between the anchor and the positive, you will need to sum over axis=-1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">pos_dist</span> = <span class="cm-variable">tf</span>.<span class="cm-property">reduce_sum</span>(<span class="cm-variable">tf</span>.<span class="cm-property">square</span>(<span class="cm-variable">tf</span>.<span class="cm-property">subtract</span>(<span class="cm-variable">anchor</span>,<span class="cm-variable">positive</span>)),<span class="cm-variable">axis</span> = <span class="cm-operator">-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 2: Compute the (encoding) distance between the anchor and the negative, you will need to sum over axis=-1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">neg_dist</span> = <span class="cm-variable">tf</span>.<span class="cm-property">reduce_sum</span>(<span class="cm-variable">tf</span>.<span class="cm-property">square</span>(<span class="cm-variable">tf</span>.<span class="cm-property">subtract</span>(<span class="cm-variable">anchor</span>,<span class="cm-variable">negative</span>)),<span class="cm-variable">axis</span> = <span class="cm-operator">-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 3: subtract the two previous distances and add alpha.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">basic_loss</span> = <span class="cm-variable">tf</span>.<span class="cm-property">add</span>(<span class="cm-variable">tf</span>.<span class="cm-property">subtract</span>(<span class="cm-variable">pos_dist</span>,<span class="cm-variable">neg_dist</span>),<span class="cm-variable">alpha</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 4: Take the maximum of basic_loss and 0.0. Sum over the training examples.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">loss</span> = <span class="cm-variable">tf</span>.<span class="cm-property">reduce_sum</span>(<span class="cm-variable">tf</span>.<span class="cm-property">maximum</span>(<span class="cm-variable">basic_loss</span>,<span class="cm-number">0</span>))    <span class="cm-comment"># 注意，这里是先取（basic_loss,0）中的最大值，再求和</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">loss</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 528px;"></div><div class="CodeMirror-gutters" style="display: none; height: 547px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 138.927px; left: 278.865px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 500px; margin-bottom: -11px; border-right-width: 19px; min-height: 161px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 273.271px; top: 133.333px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">with</span> <span class="cm-variable">tf</span>.<span class="cm-property">Session</span>() <span class="cm-keyword">as</span> <span class="cm-variable">test</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">tf</span>.<span class="cm-property">set_random_seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">y_true</span> = (<span class="cm-keyword">None</span>, <span class="cm-keyword">None</span>, <span class="cm-keyword">None</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">y_pred</span> = (<span class="cm-variable">tf</span>.<span class="cm-property">random_normal</span>([<span class="cm-number">3</span>, <span class="cm-number">128</span>], <span class="cm-variable">mean</span>=<span class="cm-number">6</span>, <span class="cm-variable">stddev</span>=<span class="cm-number">0.1</span>, <span class="cm-variable">seed</span> = <span class="cm-number">1</span>),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-variable">tf</span>.<span class="cm-property">random_normal</span>([<span class="cm-number">3</span>, <span class="cm-number">128</span>], <span class="cm-variable">mean</span>=<span class="cm-number">1</span>, <span class="cm-variable">stddev</span>=<span class="cm-number">1</span>, <span class="cm-variable">seed</span> = <span class="cm-number">1</span>),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">              <span class="cm-variable">tf</span>.<span class="cm-property">random_normal</span>([<span class="cm-number">3</span>, <span class="cm-number">128</span>], <span class="cm-variable">mean</span>=<span class="cm-number">3</span>, <span class="cm-variable">stddev</span>=<span class="cm-number">4</span>, <span class="cm-variable">seed</span> = <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">loss</span> = <span class="cm-variable">triplet_loss</span>(<span class="cm-variable">y_true</span>, <span class="cm-variable">y_pred</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-string">"loss = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">loss</span>.<span class="cm-property">eval</span>()))</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 180px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>loss = 528.143
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 228px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **loss**</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 528.143</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 247px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr style="background-color: rgb(204, 232, 207);">
        <td>
            <strong>loss</strong>
        </td>
        <td>
           528.143
        </td>
    </tr>

</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 81px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.3333px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 2 - Loading the trained model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">FaceNet is trained by minimizing the triplet loss. But since training requires a lot of data and a lot of computation, we won't train it from scratch here. Instead, we load a previously trained model. Load a model using the following cell; this might take a couple of minutes to run. </span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 81px;"></div><div class="CodeMirror-gutters" style="display: none; height: 100px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="2---Loading-the-trained-model">2 - Loading the trained model<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#2---Loading-the-trained-model">¶</a></h2>
<p>FaceNet is trained by minimizing the triplet loss. But since training requires a lot of data and a lot of computation, we won't train it from scratch here. Instead, we load a previously trained model. Load a model using the following cell; this might take a couple of minutes to run. </p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[10]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 563px; margin-bottom: -11px; border-right-width: 19px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">FRmodel</span>.<span class="cm-property">compile</span>(<span class="cm-variable">optimizer</span> = <span class="cm-string">'adam'</span>, <span class="cm-variable">loss</span> = <span class="cm-variable">triplet_loss</span>, <span class="cm-variable">metrics</span> = [<span class="cm-string">'accuracy'</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">load_weights_from_FaceNet</span>(<span class="cm-variable">FRmodel</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 64px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 145px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Here're some examples of distances between the encodings between three individuals:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/distance_matrix.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:380px;height:200px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 4**:<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span> &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> Example of distance outputs between three individuals' encodings<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's now use this model to perform face verification and face recognition! </span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 145px;"></div><div class="CodeMirror-gutters" style="display: none; height: 164px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Here're some examples of distances between the encodings between three individuals:</p>
<p><img src="./Face Recognition for the Happy House - v3_files/distance_matrix.png" style="width: 380px ; height: 200px">
<br></p>
<center> <u> <font color="purple"> <strong>Figure 4</strong>:</font></u> <br>  <font color="purple"> Example of distance outputs between three individuals' encodings</font></center>

<p>Let's now use this model to perform face verification and face recognition! </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 31px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.3333px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 3 - Applying the model</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 31px;"></div><div class="CodeMirror-gutters" style="display: none; height: 50px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="3---Applying-the-model">3 - Applying the model<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#3---Applying-the-model">¶</a></h2>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 195px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Back to the Happy House! Residents are living blissfully since you implemented happiness recognition for the house in an earlier assignment.<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">However, several issues keep coming up: The Happy House became so happy that every happy person in the neighborhood is coming to hang out in your living room. It is getting really crowded, which is having a negative impact on the residents of the house. All these random happy people are also eating all your food. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">So, you decide to change the door entry policy, and not just let random happy people enter anymore, even if they are happy! Instead, you'd like to build a <span class="cm-strong">**Face verification**</span> system so as to only let people from a specified list come in. To get admitted, each person has to swipe an ID card (identification card) to identify themselves at the door. The face recognition system then checks that they are who they claim to be. </span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 195px;"></div><div class="CodeMirror-gutters" style="display: none; height: 214px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Back to the Happy House! Residents are living blissfully since you implemented happiness recognition for the house in an earlier assignment.  </p>
<p>However, several issues keep coming up: The Happy House became so happy that every happy person in the neighborhood is coming to hang out in your living room. It is getting really crowded, which is having a negative impact on the residents of the house. All these random happy people are also eating all your food. </p>
<p>So, you decide to change the door entry policy, and not just let random happy people enter anymore, even if they are happy! Instead, you'd like to build a <strong>Face verification</strong> system so as to only let people from a specified list come in. To get admitted, each person has to swipe an ID card (identification card) to identify themselves at the door. The face recognition system then checks that they are who they claim to be. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 129px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.1 - Face Verification</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's build a database containing one encoding vector for each person allowed to enter the happy house. To generate the encoding we use <span class="cm-comment">`img_to_encoding(image_path, model)`</span> which basically runs the forward propagation of the model on the specified image. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Run the following code to build the database (represented as a python dictionary). This database maps each person's name to a 128-dimensional encoding of their face.</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 129px;"></div><div class="CodeMirror-gutters" style="display: none; height: 148px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="3.1---Face-Verification">3.1 - Face Verification<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#3.1---Face-Verification">¶</a></h3>
<p>Let's build a database containing one encoding vector for each person allowed to enter the happy house. To generate the encoding we use <code style="background-color: rgb(204, 232, 207);">img_to_encoding(image_path, model)</code> which basically runs the forward propagation of the model on the specified image. </p>
<p>Run the following code to build the database (represented as a python dictionary). This database maps each person's name to a 128-dimensional encoding of their face.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 521px; margin-bottom: -11px; border-right-width: 19px; min-height: 228px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span> = {}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"danielle"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/danielle.png"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"younes"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/younes.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"tian"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/tian.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"andrew"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/andrew.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"kian"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/kian.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"dan"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/dan.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"sebastiano"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/sebastiano.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"bertrand"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/bertrand.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"kevin"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/kevin.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"felix"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/felix.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"benoit"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/benoit.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">database</span>[<span class="cm-string">"arnaud"</span>] = <span class="cm-variable">img_to_encoding</span>(<span class="cm-string">"images/arnaud.jpg"</span>, <span class="cm-variable">FRmodel</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 247px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 195px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now, when someone shows up at your front door and swipes their ID card (thus giving you their name), you can look up their encoding in the database, and use it to check if the person standing at the front door matches the name on the ID.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement the verify() function which checks if the front-door camera picture (<span class="cm-comment">`image_path`</span>) is actually the person called "identity". You will have to go through the following steps:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Compute the encoding of the image from image_path</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Compute the distance about this encoding and the encoding of the identity image stored in the database</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">3. Open the door if the distance is less than 0.7, else do not open.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">As presented above, you should use the L2 distance (np.linalg.norm). (Note: In this implementation, compare the L2 distance, not the square of the L2 distance, to the threshold 0.7.) </span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 195px;"></div><div class="CodeMirror-gutters" style="display: none; height: 214px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Now, when someone shows up at your front door and swipes their ID card (thus giving you their name), you can look up their encoding in the database, and use it to check if the person standing at the front door matches the name on the ID.</p>
<p><strong>Exercise</strong>: Implement the verify() function which checks if the front-door camera picture (<code style="background-color: rgb(204, 232, 207);">image_path</code>) is actually the person called "identity". You will have to go through the following steps:</p>
<ol>
<li>Compute the encoding of the image from image_path</li>
<li>Compute the distance about this encoding and the encoding of the identity image stored in the database</li>
<li>Open the door if the distance is less than 0.7, else do not open.</li>
</ol>
<p>As presented above, you should use the L2 distance (np.linalg.norm). (Note: In this implementation, compare the L2 distance, not the square of the L2 distance, to the threshold 0.7.) </p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[16]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 829px; margin-bottom: -11px; border-right-width: 19px; min-height: 611px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: verify</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">verify</span>(<span class="cm-variable">image_path</span>, <span class="cm-variable">identity</span>, <span class="cm-variable">database</span>, <span class="cm-variable">model</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Function that verifies if the person on the "image_path" image is "identity".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    image_path -- path to an image</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    identity -- string, name of the person you'd like to verify the identity. Has to be a resident of the Happy house.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    database -- python dictionary mapping names of allowed people's names (strings) to their encodings (vectors).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    model -- your Inception model instance in Keras</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    dist -- distance between the image_path and the image of "identity" in the database.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    door_open -- True, if the door should open. False otherwise.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 1: Compute the encoding for the image. Use img_to_encoding() see example above. (≈ 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">encoding</span> = <span class="cm-variable">img_to_encoding</span>(<span class="cm-variable">image_path</span>,<span class="cm-variable">model</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 2: Compute distance with identity's image (≈ 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dist</span> = <span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">encoding</span> <span class="cm-operator">-</span> <span class="cm-variable">database</span>[<span class="cm-variable">identity</span>])    <span class="cm-comment"># 用门前摄像机拍摄的照片的编码 和 数据库中特定人的编码做差，计算距离   </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                                                            <span class="cm-comment"># 这里用 np.linalg.norm 计算的 L2距离</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Step 3: Open the door if dist &lt; 0.7, else don't open (≈ 3 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">dist</span> <span class="cm-operator">&lt;</span> <span class="cm-number">0.7</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span>(<span class="cm-string">"It's "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">identity</span>) <span class="cm-operator">+</span> <span class="cm-string">", welcome home!"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">door_open</span> = <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span>(<span class="cm-string">"It's not "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">identity</span>) <span class="cm-operator">+</span> <span class="cm-string">", please go away"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">door_open</span> = <span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">dist</span>, <span class="cm-variable">door_open</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 611px;"></div><div class="CodeMirror-gutters" style="display: none; height: 630px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 78px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Younes is trying to enter the Happy House and the camera takes a picture of him ("images/camera_0.jpg"). Let's run your verification algorithm on this picture:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/camera_0.jpg"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:100px;height:100px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 97px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Younes is trying to enter the Happy House and the camera takes a picture of him ("images/camera_0.jpg"). Let's run your verification algorithm on this picture:</p>
<p><img src="./Face Recognition for the Happy House - v3_files/camera_0.jpg" style="width: 100px ; height: 100px"></p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[24]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 409px; margin-bottom: -11px; border-right-width: 19px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">verify</span>(<span class="cm-string">"images/camera_0.jpg"</span>, <span class="cm-string">"younes"</span>, <span class="cm-variable">database</span>, <span class="cm-variable">FRmodel</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 47px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>It's not younes, please go away
</pre></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[24]:</div><div class="output_subarea output_text output_result"><pre>(1.0218929, False)</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 228px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **It's younes, welcome home!**</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (0.65939283, True)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 247px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr style="background-color: rgb(204, 232, 207);">
        <td>
            <strong>It's younes, welcome home!</strong>
        </td>
        <td>
           (0.65939283, True)
        </td>
    </tr>

</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 78px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Benoit, who broke the aquarium last weekend, has been banned from the house and removed from the database. He stole Kian's ID card and came back to the house to try to present himself as Kian. The front-door camera took a picture of Benoit ("images/camera_2.jpg). Let's run the verification algorithm to check if benoit can enter.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/camera_2.jpg"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:100px;height:100px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 97px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Benoit, who broke the aquarium last weekend, has been banned from the house and removed from the database. He stole Kian's ID card and came back to the house to try to present himself as Kian. The front-door camera took a picture of Benoit ("images/camera_2.jpg). Let's run the verification algorithm to check if benoit can enter.
<img src="./Face Recognition for the Happy House - v3_files/camera_2.jpg" style="width: 100px ; height: 100px"></p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[18]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 395px; margin-bottom: -11px; border-right-width: 19px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">verify</span>(<span class="cm-string">"images/camera_2.jpg"</span>, <span class="cm-string">"kian"</span>, <span class="cm-variable">database</span>, <span class="cm-variable">FRmodel</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 47px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>It's not kian, please go away
</pre></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[18]:</div><div class="output_subarea output_text output_result"><pre>(0.86224014, False)</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 228px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **It's not kian, please go away**</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (0.86224014, False)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 247px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr style="background-color: rgb(204, 232, 207);">
        <td>
            <strong>It's not kian, please go away</strong>
        </td>
        <td>
           (0.86224014, False)
        </td>
    </tr>

</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 329px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.2 - Face Recognition</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Your face verification system is mostly working well. But since Kian got his ID card stolen, when he came back to the house that evening he couldn't get in! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To reduce such shenanigans, you'd like to change your face verification system to a face recognition system. This way, no one has to carry an ID card anymore. An authorized person can just walk up to the house, and the front door will unlock for them! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You'll implement a face recognition system that takes as input an image, and figures out if it is one of the authorized persons (and if so, who). Unlike the previous face verification system, we will no longer get a person's name as another input. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement <span class="cm-comment">`who_is_it()`</span>. You will have to go through the following steps:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">1. Compute the target encoding of the image from image_path</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">2. Find the encoding from the database that has smallest distance with the target encoding. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Initialize the </span><span class="cm-comment cm-variable-3">`min_dist`</span><span class="cm-variable-3"> variable to a large enough number (100). It will help you keep track of what is the closest encoding to the input's encoding.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- Loop over the database dictionary's names and encodings. To loop use </span><span class="cm-comment cm-variable-3">`for (name, db_enc) in database.items()`</span><span class="cm-variable-3">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- Compute L2 distance between the target "encoding" and the current "encoding" from the database.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- If this distance is less than the min_dist, then set min_dist to dist, and identity to name.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 329px;"></div><div class="CodeMirror-gutters" style="display: none; height: 348px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="3.2---Face-Recognition">3.2 - Face Recognition<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#3.2---Face-Recognition">¶</a></h3>
<p>Your face verification system is mostly working well. But since Kian got his ID card stolen, when he came back to the house that evening he couldn't get in! </p>
<p>To reduce such shenanigans, you'd like to change your face verification system to a face recognition system. This way, no one has to carry an ID card anymore. An authorized person can just walk up to the house, and the front door will unlock for them! </p>
<p>You'll implement a face recognition system that takes as input an image, and figures out if it is one of the authorized persons (and if so, who). Unlike the previous face verification system, we will no longer get a person's name as another input. </p>
<p><strong>Exercise</strong>: Implement <code style="background-color: rgb(204, 232, 207);">who_is_it()</code>. You will have to go through the following steps:</p>
<ol>
<li>Compute the target encoding of the image from image_path</li>
<li>Find the encoding from the database that has smallest distance with the target encoding. <ul>
<li>Initialize the <code style="background-color: rgb(204, 232, 207);">min_dist</code> variable to a large enough number (100). It will help you keep track of what is the closest encoding to the input's encoding.</li>
<li>Loop over the database dictionary's names and encodings. To loop use <code style="background-color: rgb(204, 232, 207);">for (name, db_enc) in database.items()</code>.<ul>
<li>Compute L2 distance between the target "encoding" and the current "encoding" from the database.</li>
<li>If this distance is less than the min_dist, then set min_dist to dist, and identity to name.</li>
</ul>
</li>
</ul>
</li>
</ol>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[19]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 808px; margin-bottom: -11px; border-right-width: 19px; min-height: 761px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: who_is_it</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">who_is_it</span>(<span class="cm-variable">image_path</span>, <span class="cm-variable">database</span>, <span class="cm-variable">model</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implements face recognition for the happy house by finding who is the person on the image_path image.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    image_path -- path to an image</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    database -- database containing image encodings along with the name of the person on the image</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    model -- your Inception model instance in Keras</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    min_dist -- the minimum distance between image_path encoding and the encodings from the database</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    identity -- string, the name prediction for the person on image_path</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">## Step 1: Compute the target "encoding" for the image. Use img_to_encoding() see example above. ## (≈ 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">encoding</span> = <span class="cm-variable">img_to_encoding</span>(<span class="cm-variable">image_path</span>,<span class="cm-variable">model</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">## Step 2: Find the closest encoding ##</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Initialize "min_dist" to a large value, say 100 (≈1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">min_dist</span> = <span class="cm-number">100</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Loop over the database dictionary's names and encodings.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> (<span class="cm-variable">name</span>, <span class="cm-variable">db_enc</span>) <span class="cm-keyword">in</span> <span class="cm-variable">database</span>.<span class="cm-property">items</span>():</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Compute L2 distance between the target "encoding" and the current "emb" from the database. (≈ 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dist</span> = <span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">encoding</span> <span class="cm-operator">-</span> <span class="cm-variable">db_enc</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># If this distance is less than the min_dist, then set min_dist to dist, and identity to name. (≈ 3 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">dist</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">min_dist</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">min_dist</span> = <span class="cm-variable">dist</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">identity</span> = <span class="cm-variable">name</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">min_dist</span> <span class="cm-operator">&gt;</span> <span class="cm-number">0.7</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span>(<span class="cm-string">"Not in the database."</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span> (<span class="cm-string">"it's "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">identity</span>) <span class="cm-operator">+</span> <span class="cm-string">", the distance is "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">min_dist</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">min_dist</span>, <span class="cm-variable">identity</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 761px;"></div><div class="CodeMirror-gutters" style="display: none; height: 780px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6665px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Younes is at the front-door and the camera takes a picture of him ("images/camera_0.jpg"). Let's see if your who_it_is() algorithm identifies Younes. </span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 64px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Younes is at the front-door and the camera takes a picture of him ("images/camera_0.jpg"). Let's see if your who_it_is() algorithm identifies Younes. </p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[27]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 332px; margin-bottom: -11px; border-right-width: 19px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">who_is_it</span>(<span class="cm-string">"images/self.jpg"</span>, <span class="cm-variable">database</span>, <span class="cm-variable">FRmodel</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 47px; background-color: rgb(204, 232, 207);"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>it's benoit, the distance is 0.672825
</pre></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[27]:</div><div class="output_subarea output_text output_result"><pre>(0.67282456, 'benoit')</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none; background-color: rgb(204, 232, 207);">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 228px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  **it's younes, the distance is 0.659393**</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (0.65939283, 'younes')</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 247px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr style="background-color: rgb(204, 232, 207);">
        <td>
            <strong>it's younes, the distance is 0.659393</strong>
        </td>
        <td>
           (0.65939283, 'younes')
        </td>
    </tr>

</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You can change "<span class="cm-comment">`camera_0.jpg`</span>" (picture of younes) to "<span class="cm-comment">`camera_1.jpg`</span>" (picture of bertrand) and see the result.</span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 47px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>You can change "<code style="background-color: rgb(204, 232, 207);">camera_0.jpg</code>" (picture of younes) to "<code style="background-color: rgb(204, 232, 207);">camera_1.jpg</code>" (picture of bertrand) and see the result.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 178px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Your Happy House is running well. It only lets in authorized persons, and people don't need to carry an ID card around anymore! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You've now seen how a state-of-the-art face recognition system works.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Although we won't implement it here, here're some ways to further improve the algorithm:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Put more images of each person (under different lighting conditions, taken on different days, etc.) into the database. Then given a new image, compare the new face to multiple pictures of the person. This would increae accuracy.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Crop the images to just contain the face, and less of the "border" region around the face. This preprocessing removes some of the irrelevant pixels around the face, and also makes the algorithm more robust.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 178px;"></div><div class="CodeMirror-gutters" style="display: none; height: 197px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Your Happy House is running well. It only lets in authorized persons, and people don't need to carry an ID card around anymore! </p>
<p>You've now seen how a state-of-the-art face recognition system works.</p>
<p>Although we won't implement it here, here're some ways to further improve the algorithm:</p>
<ul>
<li>Put more images of each person (under different lighting conditions, taken on different days, etc.) into the database. Then given a new image, compare the new face to multiple pictures of the person. This would increae accuracy.</li>
<li>Crop the images to just contain the face, and less of the "border" region around the face. This preprocessing removes some of the irrelevant pixels around the face, and also makes the algorithm more robust.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 111px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'blue'</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">**What you should remember**:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Face verification solves an easier 1:1 matching problem; face recognition addresses a harder 1:K matching problem. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- The triplet loss is an effective loss function for training a neural network to learn an encoding of a face image.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- The same encoding can be used for verification and recognition. Measuring distances between two images' encodings allows you to determine whether they are pictures of the same person. </span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 111px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><font color="blue">
<strong>What you should remember</strong>:
</font></p><ul><font color="blue">
<li>Face verification solves an easier 1:1 matching problem; face recognition addresses a harder 1:K matching problem. </li>
<li>The triplet loss is an effective loss function for training a neural network to learn an encoding of a face image.</li>
<li>The same encoding can be used for verification and recognition. Measuring distances between two images' encodings allows you to determine whether they are pictures of the same person. </li>
</font></ul><font color="blue">
</font><p></p></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.6667px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congrats on finishing this assignment! </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 64px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Congrats on finishing this assignment! </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" style="background-color: rgb(204, 232, 207);"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none; background-color: rgb(204, 232, 207);"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-gutter-filler" cm-not-content="true" style="background-color: rgb(204, 232, 207);"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -11px; border-right-width: 19px; min-height: 179px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17.3333px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### References:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Florian Schroff, Dmitry Kalenichenko, James Philbin (2015). </span><span class="cm-link cm-variable-2">[FaceNet: A Unified Embedding for Face Recognition and Clustering]</span><span class="cm-string cm-url cm-variable-2">(https://arxiv.org/pdf/1503.03832.pdf)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Yaniv Taigman, Ming Yang, Marc'Aurelio Ranzato, Lior Wolf (2014). </span><span class="cm-link cm-variable-2">[DeepFace: Closing the gap to human-level performance in face verification]</span><span class="cm-string cm-url cm-variable-2">(https://research.fb.com/wp-content/uploads/2016/11/deepface-closing-the-gap-to-human-level-performance-in-face-verification.pdf)</span><span class="cm-variable-2"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- The pretrained model we use is inspired by Victor Sy Wang's implementation and was loaded using his code: </span><span class="cm-variable-2 cm-link">https://github.com/iwantooxxoox/Keras-OpenFace</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Our implementation also took a lot of inspiration from the official FaceNet github repository: </span><span class="cm-variable-2 cm-link">https://github.com/davidsandberg/facenet</span><span class="cm-variable-2"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 19px; width: 1px; border-bottom: 0px solid transparent; top: 179px;"></div><div class="CodeMirror-gutters" style="display: none; height: 198px; background-color: rgb(204, 232, 207);"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="References:">References:<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#References:">¶</a></h3>
<ul>
<li>Florian Schroff, Dmitry Kalenichenko, James Philbin (2015). <a href="https://arxiv.org/pdf/1503.03832.pdf" target="_blank">FaceNet: A Unified Embedding for Face Recognition and Clustering</a></li>
<li>Yaniv Taigman, Ming Yang, Marc'Aurelio Ranzato, Lior Wolf (2014). <a href="https://research.fb.com/wp-content/uploads/2016/11/deepface-closing-the-gap-to-human-level-performance-in-face-verification.pdf" target="_blank">DeepFace: Closing the gap to human-level performance in face verification</a> </li>
<li>The pretrained model we use is inspired by Victor Sy Wang's implementation and was loaded using his code: <a href="https://github.com/iwantooxxoox/Keras-OpenFace" target="_blank">https://github.com/iwantooxxoox/Keras-OpenFace</a>.</li>
<li>Our implementation also took a lot of inspiration from the official FaceNet github repository: <a href="https://github.com/davidsandberg/facenet" target="_blank">https://github.com/davidsandberg/facenet</a> </li>
</ul>
</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display: none; background-color: rgb(204, 232, 207);"><div class="tooltipbuttons"><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://hub.coursera-notebooks.org/user/gepukqzycdbjevzfhqjgdk/notebooks/week4/Face%20Recognition/Face%20Recognition%20for%20the%20Happy%20House%20-%20v3.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable" style="background-color: rgb(204, 232, 207);">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90; background-color: rgb(204, 232, 207);"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "5.0.0", "notebook_path": "/opt/conda/lib/python3.6/site-packages/notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.6.0 |Anaconda custom (64-bit)| (default, Dec 23 2016, 12:22:00) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]", "sys_executable": "/opt/conda/bin/python3", "sys_platform": "linux", "platform": "Linux-4.4.0-45-generic-x86_64-with-debian-8.8", "os_name": "posix", "default_encoding": "UTF-8"};
</script>

<script src="./Face Recognition for the Happy House - v3_files/encoding.js.下载" charset="utf-8"></script>

<script src="./Face Recognition for the Happy House - v3_files/main.min.js.下载" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div id="ambiance-notification"></div><div id="blue_light_filter" style="width: 100%; height: 100%; z-index: 2147483646; transition: -webkit-transform 10s ease-in-out; position: fixed !important; left: 0px !important; bottom: 0px !important; overflow: hidden !important; pointer-events: none !important; background: rgb(214, 107, 0); opacity: 0.2;"></div><div id="blf_status" style="position: fixed !important; width: 105px; height: 27px;	color: white; text-shadow: 1px 2px 4px #000; font-size: 20px;	font-weight: bold; background-color: blue; z-index: 2147483647;	right: 0px; top: 0px; display:none; font-family: arial,sans-serif; text-align: center;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal;"></div></div></body></html>